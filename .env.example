# Assistant 365 Bridge - Environment Configuration

# Server Configuration
PORT=3000

# API Security (Phase 3)
# Generate with: openssl rand -hex 32
# All protected endpoints require X-Assistant-Key header with this value
API_SECRET=your-secret-key-here

# Phase 2 - Microsoft Graph Integration
# Get these values from Azure Portal > App registrations > Your app
AZURE_CLIENT_ID=your-application-client-id-here
AZURE_TENANT_ID=your-directory-tenant-id-here

# Azure Authority (usually don't need to change this)
AZURE_AUTHORITY=https://login.microsoftonline.com/

# Token Storage (Persistent MSAL cache)
# MSAL will persist access/refresh tokens to this cache file (keep secure, never commit to git)
MSAL_CACHE_PATH=./data/msal-cache.json

# Legacy (older versions): refresh token JSON used only for migration/back-compat
# TOKEN_FILE_PATH=./data/tokens.json

# Microsoft Graph API
GRAPH_API_ENDPOINT=https://graph.microsoft.com/v1.0

# Logging
LOG_LEVEL=info

# --- OpenAI / Chat Agent configuration (future) ---
# 2025-12-22: Default model updated to gpt-5.2.
# Note: This repo does not currently include an OpenAI SDK client; when added,
# it should read the model from OPENAI_MODEL (or legacy MODEL_VERSION).
OPENAI_MODEL=gpt-5.2

# Optional legacy alias (supported by src/config/aiModel.js)
# MODEL_VERSION=gpt-5.2

# Optional (only needed once OpenAI API calls are implemented)
# OPENAI_API_KEY=your-openai-api-key-here

# --- Personal Task Sync Bridge (Microsoft To Do -> Apple Calendar) ---
# Where to forward normalized event payloads (e.g., Pushcut webhook, your own receiver, etc.)
APPLE_EVENT_WEBHOOK_URL=

# Optional outbound auth headers
# If set, will be sent as: Authorization: <value>
APPLE_EVENT_WEBHOOK_AUTHORIZATION=

# Optional shared secret header sent as: x-webhook-secret: <value>
APPLE_EVENT_WEBHOOK_SECRET=

# Optional: calendar name your Shortcut will target
APPLE_CALENDAR_NAME=Personal

# Defaults applied when only a due *date* is provided (no due time)
DEFAULT_EVENT_START_TIME=08:00
DEFAULT_EVENT_DURATION_MINUTES=30

# Optional: used only as a pass-through hint to Apple automation
DEFAULT_TIME_ZONE=America/Chicago

# Optional: file-backed idempotency store location and cap
TASK_SYNC_STORE_PATH=./data/task-sync/processed.json
TASK_SYNC_STORE_MAX_ENTRIES=5000
